<div id="appCapsule">

<app-titulo>
  <p titulo>Comunicados</p>
</app-titulo>

<!-- INICIO lista de COMUNICADOS -->

    <div class="section inset mt-2">
        <div class="pb-2">
            <div class="btn-container">
                  <button class="btn btn-info btn-sm" (click)="obtenerTodos()"><i class="bi bi-eye"></i>Todos</button>
                  <button class="btn btn-success btn-sm" (click)="obtenerNoLeidos()"><i class="bi bi-eye"></i>No Leidos</button>
                  <button class="btn btn-danger btn-sm" (click)="obtenerLeidos()"><i class="bi bi-eye"></i>Leidos</button>
              </div>
        </div>
        <app-spinner #appSpinner></app-spinner>
        <div class="accordion" id="accordionExample2" *ngIf="!(appSpinner.spinnerCargando | async)">
            <div *ngFor="let comunicado of comunicados; let i=index"
            [ngClass]="{'accordion-item': true, 'accordion-item-noleido': comunicado.leido === 0 }">
                <h2 class="accordion-header">
                        <a class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            [attr.data-bs-target]="'#accordion' + i" >
                            <div class="btn-container">
                                            <span class="fecha">
                                                {{comunicado.fecha}}
                                            </span>
                                            <span class="titulo">
                                                {{comunicado.titulo}}
                                            </span>
                                            <i class="bi bi-paperclip" *ngIf="comunicado.adjunto_url"></i>

                                </div>
                        </a>

                </h2>
                <div [id]="'accordion' + i" class="accordion-collapse collapse" data-bs-parent="#accordionExample2" (hidden.bs.collapse)="marcarLeido(comunicado)">
                    <div class="accordion-body">
                        <div class="row">
                            <div class="col-md-12" [innerHTML]="decodeHtml(comunicado.descripcion)"></div>
                            <div class="col-md-12" *ngIf="comunicado.adjunto_url">
                              <hr>
                              <div class="text-muted"><strong>Archivos Adjuntos:</strong></div>
                              <img *ngIf="esImagen(comunicado.adjunto_url)" [src]="comunicado.adjunto_url" class="img-fluid" style="height: auto; margin: 0 auto;">
                              <div *ngIf="!esImagen(comunicado.adjunto_url)">
                                <button  type="button" class="btn btn-outline-secondary btn-sm rounded me-1"
                                (click)="descargarAdjunto(comunicado.adjunto_url)">
                                  <ion-icon name="cloud-download"></ion-icon>
                                  {{obtenerNombreArchivo(comunicado.adjunto_url)}}
                                </button>
                              </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="accordion-item" *ngIf="comunicados.length==0">
              <h2 class="accordion-header">
                      <a class="accordion-button collapsed" type="button" data-bs-toggle="collapse">
                          <div class="btn-container">
                                          <span class="titulo">
                                              "Nada para mostrar"
                                          </span>
                              </div>
                      </a>

              </h2>
          </div>
        </div>

<!-- FIN lista de notificaciones -->

</div>

